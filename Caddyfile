dev.rtk-smart-warehouse.ru {
    encode zstd gzip

    log {
        output stdout
        format console
        level INFO
    }

    # WebSocket пути: проксируем по HTTP/1.1 к uvicorn
    reverse_proxy /api/ws/* myapp-api:8000 {
        transport http {
            versions 1.1
        }
    }

    # Остальное HTTP — обычный прокси
    reverse_proxy myapp-api:8000

    header {
        Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
    }

    tls bikita.nabkin@gmail.com
}